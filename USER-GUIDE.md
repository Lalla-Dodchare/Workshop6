# ‡∏á‡∏≤‡∏ô‡∏ù‡∏±‡πà‡∏á User + Backend ‚Äî ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ

> ‡∏≠‡πà‡∏≤‡∏ô TODO.md ‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞ ‡∏°‡∏µ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö req, Flow ‡∏ó‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö ‡πÑ‡∏ß‡πâ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö

---

## ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Claude (‡∏ñ‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ)

‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö **backend ‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô (server.js)** ‡πÅ‡∏•‡∏∞ **‡∏´‡∏ô‡πâ‡∏≤ User (page/user/)**

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏™‡∏≠‡∏ô:**
- ‡∏™‡∏≠‡∏ô‡∏ó‡∏µ‡∏•‡∏∞‡∏Ç‡∏±‡πâ‡∏ô ‡∏≠‡∏¢‡πà‡∏≤‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ "‡∏ó‡∏≥‡πÑ‡∏°" ‡∏Å‡πà‡∏≠‡∏ô "‡∏ó‡∏≥‡∏¢‡∏±‡∏á‡πÑ‡∏á" ‡πÄ‡∏™‡∏°‡∏≠
- ‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏™‡πà‡∏á‡∏°‡∏≤‡πÄ‡∏ä‡πá‡∏Ñ
- ‡∏ñ‡πâ‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ú‡∏¥‡∏î ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ß‡πà‡∏≤‡∏ú‡∏¥‡∏î‡∏ï‡∏£‡∏á‡πÑ‡∏´‡∏ô ‡∏ó‡∏≥‡πÑ‡∏°‡∏ñ‡∏∂‡∏á‡∏ú‡∏¥‡∏î ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πâ‡πÄ‡∏≠‡∏á
- ‡πÉ‡∏ä‡πâ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢
- ‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‚Äî ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏®‡∏±‡∏û‡∏ó‡πå‡∏¢‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏î‡∏µ (‡∏ä‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ):**
- ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏´‡πá‡∏ô‡∏†‡∏≤‡∏û‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡πÄ‡∏ä‡πà‡∏ô "tar = ‡πÄ‡∏≠‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏°‡∏±‡∏î‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß", "gzip = ‡πÄ‡∏≠‡∏≤‡∏Å‡πâ‡∏≠‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡∏°‡∏≤‡∏ö‡∏µ‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á"
- ‡πÉ‡∏ä‡πâ‡πÅ‡∏ú‡∏ô‡∏†‡∏≤‡∏û‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡πÄ‡∏ä‡πà‡∏ô:
  ```
  file1.jpg  ‚îÄ‚îê
  file2.pdf  ‚îÄ‚îº‚Üí  backup.tar (‡∏Å‡πâ‡∏≠‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)
  file3.png  ‚îÄ‚îò
  ```
- ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏ä‡πà‡∏ô "‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô route /files ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î xxx ‡πÄ‡∏•‡∏¢ ‡πÅ‡∏Ñ‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å ‡∏≠‡πà‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ‡πÄ‡∏õ‡πá‡∏ô ‡∏ö‡∏µ‡∏ö‡∏≠‡∏±‡∏î"
- ‡∏ö‡∏≠‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡πâ‡∏î ‡πÄ‡∏ä‡πà‡∏ô `path.join(__dirname, 'uploads')` ‚Üí `"c:\Users\peekm\...\Workshop6\uploads"`

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏´‡πâ‡∏≤‡∏°‡∏ó‡∏≥ (‡πÑ‡∏°‡πà‡∏ä‡∏≠‡∏ö ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏¢‡∏≤‡∏Å):**
- ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÅ‡∏ö‡∏ö‡∏ô‡∏≤‡∏°‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡πÄ‡∏ä‡πà‡∏ô "archiver = ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏±‡πä‡∏°‡∏™‡∏∏‡∏ç‡∏ç‡∏≤‡∏Å‡∏≤‡∏®, tar = ‡∏ñ‡∏∏‡∏á‡πÉ‡∏™‡πà‡∏Ç‡∏≠‡∏á, gzip = ‡∏î‡∏π‡∏î‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏≠‡∏≠‡∏Å" ‚Üí ‡∏á‡∏á ‡πÑ‡∏°‡πà‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à
- ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ‡∏®‡∏±‡∏û‡∏ó‡πå‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Å‡πà‡∏≠‡∏ô ‡πÄ‡∏ä‡πà‡∏ô "stream", "pipe", "buffer" ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ß‡πà‡∏≤‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏™‡∏°‡∏≠
- ‡∏´‡πâ‡∏≤‡∏°‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡∏±‡πâ‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏à‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏∞‡πÑ‡∏£ ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏£‡∏¥‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö

**‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏™‡∏≠‡∏ô:**
1. middleware ‡∏ï‡∏£‡∏ß‡∏à token ‚Äî `authenticateToken` (server.js)
2. ‡πÅ‡∏Å‡πâ upload ‡πÉ‡∏´‡πâ‡πÅ‡∏¢‡∏Å‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ï‡∏≤‡∏° user (server.js)
3. ‡∏ß‡∏≤‡∏á layout ‡∏´‡∏ô‡πâ‡∏≤ User (page/user/home.html)
4. ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô user.js ‚Äî ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° fetch ‡∏Å‡∏±‡∏ö server (page/user/user.js)
5. Tailwind CSS ‡∏´‡∏ô‡πâ‡∏≤ User

**‡∏´‡πâ‡∏≤‡∏°‡∏ó‡∏≥ (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å!):**
- ‡∏≠‡∏¢‡πà‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô `page/admin/` ‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î ‚Äî ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏≥
- ‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô DELETE /files/:filename ‚Äî ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏≥ (‡∏î‡∏π‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á)
- ‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô GET /files ‡πÅ‡∏ö‡∏ö admin (‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏∏‡∏Å user) ‚Äî ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏≥
- ‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏´‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏≠‡∏á

---

## ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ

**‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß:**
- [x] ‡∏´‡∏ô‡πâ‡∏≤ Login (index.html) ‚Äî HTML + Tailwind
- [x] POST /login + JWT token ‡∏™‡∏£‡πâ‡∏≤‡∏á + ‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö (server.js)
- [x] script.js ‡∏´‡∏ô‡πâ‡∏≤ login ‚Äî fetch ‚Üí ‡πÄ‡∏Å‡πá‡∏ö token ‚Üí redirect ‡∏ï‡∏≤‡∏° role
- [x] POST /upload, GET /files, GET /download/:filename (server.js)
- [x] middleware `authenticateToken` (server.js)
- [x] ‡πÅ‡∏Å‡πâ upload ‡πÅ‡∏¢‡∏Å‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ï‡∏≤‡∏° user id (server.js)
- [x] DELETE /files/:filename ‚Äî user + admin
- [x] GET /files ‡πÅ‡∏ö‡∏ö admin (‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏∏‡∏Å user + owner)
- [x] Download ‡πÅ‡∏ö‡∏ö admin (/download/:owner/:filename)
- [x] DELETE ‡πÅ‡∏ö‡∏ö admin (/files/:owner/:filename)
- [x] ‡∏´‡∏ô‡πâ‡∏≤ User ‚Äî layout HTML + Tailwind (page/user/home.html)
- [x] user.js ‚Äî upload/preview/list/download/delete/logout (inline ‡πÉ‡∏ô home.html)
- [x] Preview ‡∏£‡∏π‡∏õ‡∏Å‡πà‡∏≠‡∏ô upload (FileReader)
- [x] ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏ö (confirm)
- [x] POST /register + ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å + ‡πÄ‡∏ä‡πá‡∏Ñ username ‡∏ã‡πâ‡∏≥
- [x] script.js ‚Äî ‡∏™‡∏•‡∏±‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° Login/Register + ‡πÄ‡∏ä‡πá‡∏Ñ password ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô
- [x] Filter ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå (‡∏ù‡∏±‡πà‡∏á admin ‚Äî admin.js)

**‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥:**
- [x] Backup (TAR + Gzip) ‚Äî route `POST /backup` ‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß (server.js ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 162-186)
  - [x] ‡∏ä‡∏±‡πâ‡∏ô 1: ‡∏Å‡∏≥‡∏´‡∏ô‡∏î scope (admin ‚Üí ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î, user ‚Üí ‡πÅ‡∏Ñ‡πà‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á, superadmin ‚Üí ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)
  - [x] ‡∏ä‡∏±‡πâ‡∏ô 2: ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå backup ‡∏î‡πâ‡∏ß‡∏¢ timestamp
  - [x] ‡∏ä‡∏±‡πâ‡∏ô 3: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå backups/
  - [x] ‡∏ä‡∏±‡πâ‡∏ô 4: ‡∏™‡∏£‡πâ‡∏≤‡∏á stream + archiver
  - [x] ‡∏ä‡∏±‡πâ‡∏ô 5: output.on('close') ‚Üí ‡∏™‡πà‡∏á‡∏ú‡∏•‡∏Å‡∏•‡∏±‡∏ö + log
  - [x] ‡∏ä‡∏±‡πâ‡∏ô 6: archive.pipe(output) + archive.directory() + archive.finalize()
- [ ] Preview ‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‚Äî ‡∏î‡∏π‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ "Preview ‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î" ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á

**‡πÄ‡∏™‡∏£‡πá‡∏à‡πÄ‡∏û‡∏¥‡πà‡∏°:**
- [x] Recovery ‚Äî route `GET /backup/:filename/list` + `POST /backup/:filename/recover` (server.js ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 191-213)

**‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏≥:**
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏∏‡πà‡∏° Backup + Recovery ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ user (page/user/home.html)
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏∏‡πà‡∏° Backup + Recovery ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ admin ‚Äî ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏≥ (page/admin/)

---

## ‡πÅ‡∏ö‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô ‚Äî ‡πÉ‡∏Ñ‡∏£‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ        ‡∏â‡∏±‡∏ô (‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ)        ‚îÇ         ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô (‡∏ù‡∏±‡πà‡∏á Admin)        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ server.js:                       ‚îÇ server.js:                       ‚îÇ
‚îÇ  ‚úÖ middleware authenticateToken  ‚îÇ  ‚úÖ DELETE /files/:filename       ‚îÇ
‚îÇ  ‚úÖ ‡πÅ‡∏Å‡πâ upload ‡πÅ‡∏¢‡∏Å‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå       ‚îÇ  ‚úÖ GET /files ‡πÅ‡∏ö‡∏ö admin          ‚îÇ
‚îÇ  ‚ùå DELETE route (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏≥)       ‚îÇ  ‚ùå middleware (‡∏â‡∏±‡∏ô‡∏ó‡∏≥)            ‚îÇ
‚îÇ  ‚ùå GET /files admin (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏≥)   ‚îÇ  ‚ùå upload ‡πÅ‡∏¢‡∏Å‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå (‡∏â‡∏±‡∏ô‡∏ó‡∏≥)   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ page/user/:                      ‚îÇ page/admin/:                     ‚îÇ
‚îÇ  ‚úÖ home.html (layout+Tailwind)  ‚îÇ  ‚úÖ dashboard.html (layout+TW)   ‚îÇ
‚îÇ  ‚úÖ user.js (fetch ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)      ‚îÇ  ‚úÖ admin.js (fetch ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚ùå ‡∏´‡πâ‡∏≤‡∏°‡πÅ‡∏ï‡∏∞ page/admin/           ‚îÇ ‚ùå ‡∏´‡πâ‡∏≤‡∏°‡πÅ‡∏ï‡∏∞ page/user/            ‚îÇ
‚îÇ ‚ùå ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô DELETE route        ‚îÇ ‚ùå ‡∏´‡πâ‡∏≤‡∏°‡πÅ‡∏ï‡∏∞ middleware             ‚îÇ
‚îÇ ‚ùå ‡∏´‡πâ‡∏≤‡∏°‡πÅ‡∏ï‡∏∞ admin.js              ‚îÇ ‚ùå ‡∏´‡πâ‡∏≤‡∏°‡πÅ‡∏ï‡∏∞ user.js               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

> Claude: ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ‡∏Ç‡∏≠‡∏ó‡∏≥‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ù‡∏±‡πà‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô ‚Üí **‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò** ‡πÅ‡∏•‡πâ‡∏ß‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤ "‡∏≠‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏ô‡∏∞"

---

## ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥ (‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î)

### 1. middleware ‡∏ï‡∏£‡∏ß‡∏à token (server.js) ‚Äî Claude ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß + ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≤‡∏á‡∏•‡πà‡∏≤‡∏á

‡∏ó‡∏∏‡∏Å route ‡∏´‡∏•‡∏±‡∏á login ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ client ‡∏™‡πà‡∏á token ‡∏°‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡πà‡∏≤

```
client ‡∏™‡πà‡∏á request ‡∏°‡∏≤
  ‚Üí header: { Authorization: 'Bearer eyJhbG...' }
  ‚Üí middleware ‡∏î‡∏∂‡∏á token ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤
  ‚Üí jwt.verify(token, SECRET_KEY) ‚Üí ‡∏ñ‡πâ‡∏≤‡∏ñ‡∏π‡∏Å ‚Üí req.user = decoded ‚Üí next()
  ‚Üí ‡∏ñ‡πâ‡∏≤‡∏ú‡∏¥‡∏î ‚Üí res.status(401)
```

**middleware ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?**
‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô "‡∏¢‡∏≤‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ï‡∏π" ‚Äî ‡∏ó‡∏∏‡∏Å request ‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ô‡∏¢‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡πÑ‡∏õ‡∏ñ‡∏∂‡∏á route ‡∏à‡∏£‡∏¥‡∏á
function middleware ‡∏£‡∏±‡∏ö 3 ‡∏ï‡∏±‡∏ß: `(req, res, next)`
- `req` = ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà client ‡∏™‡πà‡∏á‡∏°‡∏≤
- `res` = ‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
- `next()` = ‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤ "‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏õ‡∏ó‡∏≥ route ‡∏ï‡πà‡∏≠‡πÄ‡∏•‡∏¢"

**JWT ‡∏°‡∏µ 3 ‡∏™‡πà‡∏ß‡∏ô** (‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏à‡∏∏‡∏î `.`):
```
eyJhbGciOiJI.eyJpZCI6MSwidXNl.SflKxwRJSMeKKF2
|-- Header --|-- Payload -------|-- Signature --|
```
- Header = ‡∏ö‡∏≠‡∏Å algorithm ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™
- Payload = ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ù‡∏±‡∏á‡πÑ‡∏ß‡πâ (id, username, role)
- Signature = ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏à‡∏≤‡∏Å SECRET_KEY ‚Äî ‡πÄ‡∏≠‡∏≤‡πÑ‡∏ß‡πâ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏ñ‡∏π‡∏Å‡πÅ‡∏Å‡πâ‡∏°‡∏±‡πâ‡∏¢

client ‡∏™‡πà‡∏á token ‡∏ó‡∏±‡πâ‡∏á‡∏Å‡πâ‡∏≠‡∏ô (3 ‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô) ‡∏°‡∏≤‡πÉ‡∏ô header ‚Üí server ‡πÉ‡∏ä‡πâ `jwt.verify()` ‡πÅ‡∏Å‡∏∞‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

**SECRET_KEY ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?**
‡∏£‡∏´‡∏±‡∏™‡∏•‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÅ‡∏Ñ‡πà server ‡∏£‡∏π‡πâ ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ï‡∏£‡∏≤‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó:
- ‡∏ï‡∏≠‡∏ô login ‚Üí ‡πÉ‡∏ä‡πâ `jwt.sign()` ‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡∏ï‡∏£‡∏≤‡∏•‡∏á‡∏ö‡∏ô‡∏ö‡∏±‡∏ï‡∏£ (‡∏™‡∏£‡πâ‡∏≤‡∏á token)
- ‡∏ï‡∏≠‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ ‚Üí ‡πÉ‡∏ä‡πâ `jwt.verify()` ‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏ï‡∏£‡∏≤‡∏ï‡∏£‡∏á‡∏°‡∏±‡πâ‡∏¢ (‡πÄ‡∏ä‡πá‡∏Ñ token)
- ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ SECRET_KEY ‚Üí ‡πÉ‡∏Ñ‡∏£‡∏Å‡πá‡∏õ‡∏•‡∏≠‡∏° token ‡πÑ‡∏î‡πâ

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î authenticateToken:**
```js
function authenticateToken(req, res, next) {
    // ‡∏Ç‡∏±‡πâ‡∏ô 1: ‡∏î‡∏∂‡∏á header Authorization ‚Üí ‡πÑ‡∏î‡πâ "Bearer eyJhbG..."
    const authHeader = req.headers['authorization'];
    // ‡πÅ‡∏¢‡∏Å‡πÄ‡∏≠‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞ token (‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏•‡∏±‡∏á "Bearer ")
    const token = authHeader && authHeader.split(' ')[1];

    // ‡∏Ç‡∏±‡πâ‡∏ô 2: ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ token ‡πÄ‡∏•‡∏¢ ‚Üí ‡πÑ‡∏•‡πà‡∏Å‡∏•‡∏±‡∏ö 401
    if (!token) return res.status(401).json({ error: '‡πÑ‡∏°‡πà‡∏°‡∏µ token' });

    // ‡∏Ç‡∏±‡πâ‡∏ô 3: ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ token ‡∏ñ‡∏π‡∏Å‡∏°‡∏±‡πâ‡∏¢
    jwt.verify(token, SECRET_KEY, (err, decoded) => {
        if (err) return res.status(403).json({ error: 'token ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á' });
        // decoded = ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ù‡∏±‡∏á‡πÑ‡∏ß‡πâ‡∏ï‡∏≠‡∏ô login { id, username, role }
        req.user = decoded;  // ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏´‡πâ route ‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏ï‡πà‡∏≠
        next();              // ‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏õ‡∏ï‡πà‡∏≠
    });
}
```

**‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:**
- ‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏™‡πà `const jwt = jwt.verify(...)` ‚Üí jwt ‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠ library ‡∏ó‡∏µ‡πà require ‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß ‡∏ñ‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÉ‡∏´‡∏°‡πà‡∏à‡∏∞‡∏ó‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏¥‡∏°!
- ‡∏ß‡∏≤‡∏á function ‡∏ô‡∏µ‡πâ‡πÑ‡∏ß‡πâ‡∏´‡∏•‡∏±‡∏á login route (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 45) ‡πÅ‡∏ï‡πà‡∏Å‡πà‡∏≠‡∏ô route upload/files/download

‡∏™‡∏£‡πâ‡∏≤‡∏á function `authenticateToken` ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏™‡πà‡∏Å‡πà‡∏≠‡∏ô route ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô:
```js
// ‡πÉ‡∏™‡πà‡πÑ‡∏ß‡πâ‡∏´‡∏•‡∏±‡∏á login route, ‡∏Å‡πà‡∏≠‡∏ô upload/files/download/delete route
app.post('/upload', authenticateToken, upload.single('file'), ...)
app.get('/files', authenticateToken, ...)
```

### 2. ‡πÅ‡∏Å‡πâ upload ‚Äî ‡πÅ‡∏¢‡∏Å‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ï‡∏≤‡∏° user (server.js) ‚Äî Claude ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß

‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏∏‡∏Å user ‡πÑ‡∏õ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô `uploads/` ‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô ‚Üí ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏¢‡∏Å‡πÄ‡∏õ‡πá‡∏ô:
```
uploads/
‚îú‚îÄ‚îÄ admin/
‚îÇ   ‚îî‚îÄ‚îÄ report.pdf
‚îú‚îÄ‚îÄ user1/
‚îÇ   ‚îî‚îÄ‚îÄ photo.jpg
‚îî‚îÄ‚îÄ user2/
    ‚îî‚îÄ‚îÄ notes.txt
```

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏≥:** ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô multer destination ‡∏à‡∏≤‡∏Å string ‡∏ï‡∏≤‡∏¢‡∏ï‡∏±‡∏ß ‚Üí ‡πÄ‡∏õ‡πá‡∏ô function

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î:**
```js
const storage = multer.diskStorage({
    destination: (req, file, cb) => {
        const userFolder = path.join('uploads', req.user.username);
        fs.mkdirSync(userFolder, { recursive: true });
        cb(null, userFolder);
    },
    filename: (req, file, cb) => {
        cb(null, file.originalname);
    }
});
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ó‡∏µ‡∏•‡∏∞‡∏ï‡∏±‡∏ß:**

`destination: (req, file, cb) => { ... }`
- `req` = request ‚Äî ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà client ‡∏™‡πà‡∏á‡∏°‡∏≤ (‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á req.user ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å token)
- `file` = ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î (‡∏°‡∏µ file.originalname, file.size ‡∏Ø‡∏•‡∏Ø)
- `cb` = callback ‚Äî function ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡∏≠‡∏Å multer ‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÅ‡∏ö‡∏ö `cb(error, ‡∏Ñ‡πà‡∏≤)`

`path.join('uploads', req.user.username)`
- `path` = library ‡∏Ç‡∏≠‡∏á Node.js ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå
- `.join()` = ‡πÄ‡∏≠‡∏≤‡∏´‡∏•‡∏≤‡∏¢‡∏™‡πà‡∏ß‡∏ô‡∏°‡∏≤‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô path ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: `uploads/user1`

`fs.mkdirSync(userFolder, { recursive: true })`
- `fs` = library ‡∏Ç‡∏≠‡∏á Node.js ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå/‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå
- `.mkdirSync()` = ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå (mkdir = make directory, Sync = ‡∏£‡∏≠‡∏à‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à)
- `{ recursive: true }` = ‡∏ñ‡πâ‡∏≤ parent folder ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏î‡πâ‡∏ß‡∏¢

`cb(null, userFolder)`
- ‡∏ï‡∏±‡∏ß‡πÅ‡∏£‡∏Å `null` = ‡πÑ‡∏°‡πà‡∏°‡∏µ error
- ‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á = ‡∏ö‡∏≠‡∏Å multer ‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ

**‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:** ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà `authenticateToken` ‡πÉ‡∏ô route ‡∏î‡πâ‡∏ß‡∏¢ ‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô req.user ‡∏à‡∏∞ undefined!
```js
app.post('/upload', authenticateToken, upload.single('file'), ...)
app.get('/files', authenticateToken, ...)
app.get('/download/:filename', authenticateToken, ...)
```

route `/files` ‡∏Å‡∏±‡∏ö `/download` ‡∏Å‡πá‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ path ‡πÉ‡∏´‡πâ‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á user:
```js
// /files ‚Üí ‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á user ‡∏Ñ‡∏ô‡∏ô‡∏±‡πâ‡∏ô
fs.readdir(path.join('uploads', req.user.username), ...)

// /download ‚Üí ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á user
path.join(__dirname, 'uploads', req.user.username, req.params.filename)
```

### 3. ‡∏ß‡∏≤‡∏á layout ‡∏´‡∏ô‡πâ‡∏≤ User (page/user/home.html)

> ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: DELETE /files/:filename ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡πÉ‡∏ô server.js ‚Äî ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡πÄ‡∏≠‡∏á

‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ:
- ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ "File Manager" + ‡∏ä‡∏∑‡πà‡∏≠ user
- ‡∏õ‡∏∏‡πà‡∏° Logout
- ‡∏™‡πà‡∏ß‡∏ô Upload: input file + ‡∏ä‡πà‡∏≠‡∏á preview + ‡∏õ‡∏∏‡πà‡∏° Upload
- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå: ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå, ‡∏õ‡∏∏‡πà‡∏° Download, ‡∏õ‡∏∏‡πà‡∏° ‡∏•‡∏ö

### 4. ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô user.js (page/user/user.js)

```js
// --- ‡πÄ‡∏ä‡πá‡∏Ñ token ---
// ‡∏î‡∏∂‡∏á token ‡∏à‡∏≤‡∏Å localStorage ‚Üí ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ ‚Üí redirect ‡∏Å‡∏•‡∏±‡∏ö login

// --- ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå ---
// fetch GET /files + header Authorization ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á

// --- Upload ---
// ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå ‚Üí FileReader preview ‚Üí ‡∏Å‡∏î upload ‚Üí fetch POST /upload + FormData + token

// --- Download ---
// ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° ‚Üí window.open('/download/:filename') ‡∏´‡∏£‡∏∑‡∏≠ fetch + blob

// --- Delete ---
// ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° ‚Üí confirm() ‚Üí fetch DELETE /files/:filename + token ‚Üí ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà

// --- Logout ---
// localStorage.removeItem('token') ‚Üí redirect ‡∏Å‡∏•‡∏±‡∏ö login
```

### 5. Tailwind CSS ‡∏´‡∏ô‡πâ‡∏≤ User

‡πÉ‡∏ä‡πâ Tailwind ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏ß‡∏¢ ‚Äî ‡∏î‡∏π‡∏´‡∏ô‡πâ‡∏≤ login (index.html) ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á

---

## ‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏à‡∏≤‡∏Å‡∏≠‡∏à.

| ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ | ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô | ‡∏ó‡∏≥‡πÅ‡∏•‡πâ‡∏ß? |
|--------|--------|---------|
| User ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ | 3 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ö admin) | ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà |
| Upload ‡πÑ‡∏ü‡∏•‡πå Client ‚Üí Server | 4+3 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (‡∏£‡∏ß‡∏°) | API ‡∏°‡∏µ ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° fe |
| Download ‡πÑ‡∏ü‡∏•‡πå Server ‚Üí Client | | API ‡∏°‡∏µ ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° fe |
| Fetch API ‡∏™‡πà‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ú‡πà‡∏≤‡∏ô HTTP POST | | ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ |
| ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô Server | | API ‡∏°‡∏µ ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á fe |
| Preview ‡πÑ‡∏ü‡∏•‡πå‡∏Å‡πà‡∏≠‡∏ô upload (FileReader) | | ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ |
| ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏ö (confirm) | | ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ |
| UI ‡∏ô‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô | | login ‡∏™‡∏ß‡∏¢ ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏¢‡∏±‡∏á |

---

## ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏î‡∏™‡∏≠‡∏ö

1. `node server.js`
2. ‡πÄ‡∏õ‡∏¥‡∏î `http://localhost:3000`
3. login `user1` / `user123` ‚Üí ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ user
4. login `admin` / `admin123` ‚Üí ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ admin

---

## ‡∏ñ‡πâ‡∏≤‡∏ï‡∏¥‡∏î‡∏≠‡∏∞‡πÑ‡∏£

‡∏ñ‡∏≤‡∏° Claude ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‚Äî ‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤ "‡∏ó‡∏≥‡∏ù‡∏±‡πà‡∏á user + backend ‡∏≠‡∏¢‡∏π‡πà" ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏ñ‡∏π‡∏Å‡∏à‡∏∏‡∏î
‡∏≠‡πà‡∏≤‡∏ô TODO.md ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ "‡∏™‡∏£‡∏∏‡∏õ req" ‡∏î‡πâ‡∏ß‡∏¢ ‡∏°‡∏µ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ req.body, req.params, req.headers ‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î

---

## ‡∏á‡∏≤‡∏ô Extra (‡∏ó‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏´‡∏î)

> ‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏™‡∏£‡πá‡∏à 100% ‡πÅ‡∏•‡πâ‡∏ß ‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠ feature ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡πÇ‡∏î‡∏î‡πÄ‡∏î‡πà‡∏ô

### 1. ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å (Register) ‚Äî ‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß
- ~~‡πÄ‡∏û‡∏¥‡πà‡∏° form ‡πÉ‡∏ô index.html~~
- ~~‡πÄ‡∏û‡∏¥‡πà‡∏° `POST /register` ‡πÉ‡∏ô server.js~~
- ~~‡πÄ‡∏ä‡πá‡∏Ñ username ‡∏ã‡πâ‡∏≥‡∏Å‡πà‡∏≠‡∏ô push~~

### 2. Preview ‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‚Äî üî® ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥

**‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏î‡πâ:**
- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏™‡∏î‡∏á thumbnail ‡πÄ‡∏•‡πá‡∏Å‡πÜ + ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ü‡∏•‡πå (‡∏ä‡∏∑‡πà‡∏≠, ‡∏Ç‡∏ô‡∏≤‡∏î, ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó, ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î)
- ‡∏î‡∏±‡∏ö‡πÄ‡∏ö‡∏¥‡πâ‡∏•‡∏Ñ‡∏•‡∏¥‡∏Å ‚Üí ‡πÄ‡∏õ‡∏¥‡∏î modal ‡∏î‡∏π‡πÅ‡∏ö‡∏ö‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ macOS file info)
- Preview ‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÑ‡∏ü‡∏•‡πå: ‡∏£‡∏π‡∏õ ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ, PDF ‚Üí iframe, ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‚Üí ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô
- ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÅ‡∏™‡∏î‡∏á dimensions (‡∏Å‡∏ß‡πâ‡∏≤‡∏á x ‡∏™‡∏π‡∏á px) ‡∏î‡πâ‡∏ß‡∏¢

**‡πÑ‡∏≠‡πÄ‡∏î‡∏µ‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°:**
- Zoom ‡πÄ‡∏Ç‡πâ‡∏≤/‡∏≠‡∏≠‡∏Å ‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÉ‡∏ô modal
- Slideshow ‚Äî ‡∏Å‡∏î‡∏•‡∏π‡∏Å‡∏®‡∏£‡∏ã‡πâ‡∏≤‡∏¢/‡∏Ç‡∏ß‡∏≤‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡πÉ‡∏ô modal
- Drag & Drop upload ‚Äî ‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏î choose file

**‡∏ï‡∏¥‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤ / ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏Å‡πà‡∏≠‡∏ô:**
- `GET /files` ‡∏ù‡∏±‡πà‡∏á user ‡∏™‡πà‡∏á‡πÅ‡∏Ñ‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå (string) ‚Üí ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á object ‡∏ó‡∏µ‡πà‡∏°‡∏µ size, type, birthtime, dimensions ‡∏°‡∏≤‡∏î‡πâ‡∏ß‡∏¢
- ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ `fs.statSync()` ‡∏î‡∏∂‡∏á size + birthtime
- ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ library `image-size` (npm) ‡∏î‡∏∂‡∏á dimensions ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏π‡∏õ
- home.html ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡∏ï‡∏≤‡∏£‡∏≤‡∏á + ‡πÄ‡∏û‡∏¥‡πà‡∏° modal HTML + ‡πÄ‡∏û‡∏¥‡πà‡∏° JS ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ dblclick/modal

**‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥:**
1. `npm install image-size`
2. ‡πÅ‡∏Å‡πâ `GET /files` ‡πÉ‡∏ô server.js ‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á { filename, size, type, birthtime, dimensions }
3. ‡πÅ‡∏Å‡πâ home.html ‚Äî ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏™‡∏î‡∏á thumbnail + ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡πà‡∏≠
4. ‡πÄ‡∏û‡∏¥‡πà‡∏° modal HTML + CSS (Tailwind)
5. ‡πÄ‡∏û‡∏¥‡πà‡∏° JS ‚Äî dblclick ‡πÄ‡∏õ‡∏¥‡∏î modal, ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î, preview ‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÑ‡∏ü‡∏•‡πå
6. ‡πÄ‡∏û‡∏¥‡πà‡∏° Zoom / Slideshow / Drag & Drop (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÄ‡∏ß‡∏•‡∏≤)

### 3. ‡πÅ‡∏ä‡∏£‡πå‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡πâ‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ (Share)
- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏∏‡πà‡∏° Share ‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå
- ‡πÄ‡∏û‡∏¥‡πà‡∏° `POST /share` ‡πÉ‡∏ô server.js ‚Äî ‡∏£‡∏±‡∏ö filename + username ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏ä‡∏£‡πå‡πÉ‡∏´‡πâ
- ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡πà‡∏≤‡πÉ‡∏Ñ‡∏£‡πÅ‡∏ä‡∏£‡πå‡πÉ‡∏´‡πâ‡πÉ‡∏Ñ‡∏£ (‡πÄ‡∏û‡∏¥‡πà‡∏° field `sharedBy` ‡πÉ‡∏ô response)
- ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ß‡πà‡∏≤ "‡πÅ‡∏ä‡∏£‡πå‡πÇ‡∏î‡∏¢ username"

### 4. Filter ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå ‚Äî ‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß (‡∏ù‡∏±‡πà‡∏á admin)

### 5. UI ‡∏™‡∏ß‡∏¢
- ‡πÄ‡∏û‡∏¥‡πà‡∏° hover effect ‡∏ö‡∏ô‡πÅ‡∏ñ‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á
- ‡∏õ‡∏∏‡πà‡∏° Download/‡∏•‡∏ö ‡πÉ‡∏™‡πà Tailwind class ‡∏™‡∏µ‡∏™‡∏±‡∏ô
- ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á (‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ GET /files)

### 6. Backup (TAR + Gzip) ‚Äî ‡∏â‡∏±‡∏ô‡∏ó‡∏≥

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å: TAR + Gzip (`.tar.gz`)**

**‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å:**
- TAR ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏ö‡∏µ‡∏ö ‚Üí ‡πÄ‡∏´‡πá‡∏ô pattern ‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏î‡πâ ‚Üí ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏•‡πá‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏ö‡∏µ‡∏ö‡∏ó‡∏µ‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå
- Recovery ‡∏á‡πà‡∏≤‡∏¢ ‚Äî ‡πÅ‡∏ï‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÑ‡∏î‡πâ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ñ‡∏∑‡∏ô‡∏°‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- ‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏° ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å OS
- ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á install native binding ‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏û‡∏±‡∏á‡∏ö‡∏ô Windows

**‡πÉ‡∏ä‡πâ library:** `archiver` (npm) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á backup, `tar` (npm) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡∏Å/‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô

#### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô

- [ ] `npm install archiver tar`
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `backups/`
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á route `POST /backup` (admin ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)
  ```js
  const archiver = require('archiver');

  app.post('/backup', authenticateToken, (req, res) => {
      if (req.user.role !== 'admin') return res.status(403).json({ error: '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå' });
      const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
      const backupFile = path.join(__dirname, 'backups', `${timestamp}.tar.gz`);

      const output = fs.createWriteStream(backupFile);
      const archive = archiver('tar', { gzip: true, zlib: { level: 9 } });

      output.on('close', () => {
          logActivity('BACKUP', req.user.username, backupFile);
          res.json({ message: 'Backup ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', file: backupFile, size: archive.pointer() });
      });

      archive.pipe(output);
      archive.directory('./uploads', false);
      archive.finalize();
  });
  ```
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏∏‡πà‡∏° Backup ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ admin dashboard

#### ‡∏ó‡∏£‡∏¥‡∏Ñ

- **‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ backup ‡∏î‡πâ‡∏ß‡∏¢ timestamp** ‚Äî ‡πÄ‡∏ä‡πà‡∏ô `2026-02-24T10-30-00.tar.gz` ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏ó‡∏±‡∏ö‡∏Å‡∏±‡∏ô
- **backup ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢** ‚Äî ‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å
- **‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà ~60-65%** ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö copy ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤

---

### 7. Recovery (‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏à‡∏≤‡∏Å Backup) ‚Äî ‡∏â‡∏±‡∏ô‡∏ó‡∏≥

**‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î: ‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô 2 ‡∏Å‡∏£‡∏ì‡∏µ**

```
‡∏Å‡∏£‡∏ì‡∏µ A: ‡∏Å‡∏π‡πâ‡∏ö‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå (1 ‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)
    ‚Üí ‡πÅ‡∏ï‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‚Üí ‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ uploads/
    ‚Üí ‡πÅ‡∏û‡πá‡∏Ñ .tar.gz ‡πÉ‡∏´‡∏°‡πà ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏Å‡∏π‡πâ‡πÅ‡∏•‡πâ‡∏ß

‡∏Å‡∏£‡∏ì‡∏µ B: ‡∏Å‡∏π‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡πÑ‡∏ü‡∏•‡πå)
    ‚Üí ‡πÅ‡∏ï‡∏Å‡∏ó‡∏∏‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ ‚Üí ‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ uploads/
    ‚Üí ‡∏•‡∏ö .tar.gz ‡∏ó‡∏¥‡πâ‡∏á‡πÄ‡∏•‡∏¢ (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏û‡πá‡∏Ñ‡πÉ‡∏´‡∏°‡πà)
```

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏¢‡∏Å‡∏Å‡∏£‡∏ì‡∏µ:** ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å vs ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô backup
```js
if (selectedFiles.length === totalFilesInBackup) {
    // ‡∏Å‡∏£‡∏ì‡∏µ B ‚Äî ‡πÅ‡∏ï‡∏Å‡∏´‡∏°‡∏î ‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏ö .tar.gz ‡∏ó‡∏¥‡πâ‡∏á
} else {
    // ‡∏Å‡∏£‡∏ì‡∏µ A ‚Äî ‡πÅ‡∏ï‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏û‡πá‡∏Ñ‡πÉ‡∏´‡∏°‡πà
}
```

#### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô

- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á route `GET /backup/:filename/list` ‚Äî ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô backup (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏ï‡∏Å)
  ```js
  const tar = require('tar');

  // ‡πÉ‡∏ä‡πâ tar.t() ‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á
  app.get('/backup/:filename/list', authenticateToken, (req, res) => {
      const files = [];
      tar.t({
          file: path.join(__dirname, 'backups', req.params.filename),
          onReadEntry: entry => files.push({ path: entry.path, size: entry.size })
      }).then(() => res.json(files));
  });
  ```
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á route `POST /restore` ‚Äî ‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
  ```js
  app.post('/restore', authenticateToken, async (req, res) => {
      const { backupFile, selectedFiles, totalFiles } = req.body;

      // ‡πÅ‡∏ï‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ uploads/
      await tar.x({
          file: path.join(__dirname, 'backups', backupFile),
          cwd: path.join(__dirname, 'uploads')
      }, selectedFiles);

      if (selectedFiles.length === totalFiles) {
          // ‡∏Å‡∏£‡∏ì‡∏µ B ‚Äî ‡∏Å‡∏π‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‚Üí ‡∏•‡∏ö backup ‡∏ó‡∏¥‡πâ‡∏á
          fs.unlinkSync(path.join(__dirname, 'backups', backupFile));
      } else {
          // ‡∏Å‡∏£‡∏ì‡∏µ A ‚Äî ‡∏Å‡∏π‡πâ‡∏ö‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå ‚Üí ‡πÅ‡∏û‡πá‡∏Ñ backup ‡πÉ‡∏´‡∏°‡πà (‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏Å‡∏π‡πâ‡πÅ‡∏•‡πâ‡∏ß)
          // ‡πÅ‡∏ï‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÑ‡∏õ temp ‚Üí ‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏Å‡∏π‡πâ‡πÅ‡∏•‡πâ‡∏ß ‚Üí ‡πÅ‡∏û‡πá‡∏Ñ‡πÉ‡∏´‡∏°‡πà ‚Üí ‡∏•‡∏ö temp
      }

      logActivity('RESTORE', req.user.username, selectedFiles.join(', '));
      res.json({ message: '‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', restored: selectedFiles.length });
  });
  ```
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° UI ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ admin dashboard ‚Äî ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ backup + ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô

#### ‡∏ó‡∏£‡∏¥‡∏Ñ

- **‡∏î‡∏π‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏ï‡∏Å** ‚Äî ‡πÉ‡∏ä‡πâ `tar.t()` list ‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô backup ‡πÉ‡∏´‡πâ user ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡πà‡∏≠‡∏ô ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏ï‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏Å‡πâ‡∏≠‡∏ô
- **‡∏Å‡∏π‡πâ‡∏ö‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå ‚Üí ‡πÅ‡∏û‡πá‡∏Ñ‡πÉ‡∏´‡∏°‡πà** ‚Äî ‡πÄ‡∏≠‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÅ‡∏û‡πá‡∏Ñ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô .tar.gz ‡πÉ‡∏´‡∏°‡πà
- **‡∏Å‡∏π‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‚Üí ‡∏•‡∏ö backup ‡∏ó‡∏¥‡πâ‡∏á** ‚Äî ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö backup ‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤

#### ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥ (Backup + Recovery)

| ‡∏•‡∏≥‡∏î‡∏±‡∏ö | ‡∏á‡∏≤‡∏ô | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å |
|-------|-----|---------|
| 1 | `npm install archiver tar` | ‡∏á‡πà‡∏≤‡∏¢‡∏°‡∏≤‡∏Å |
| 2 | ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `backups/` | ‡∏á‡πà‡∏≤‡∏¢‡∏°‡∏≤‡∏Å |
| 3 | ‡∏™‡∏£‡πâ‡∏≤‡∏á route `POST /backup` (TAR + Gzip) | ‡∏Å‡∏•‡∏≤‡∏á |
| 4 | ‡∏™‡∏£‡πâ‡∏≤‡∏á route `GET /backup/:filename/list` | ‡∏Å‡∏•‡∏≤‡∏á |
| 5 | ‡∏™‡∏£‡πâ‡∏≤‡∏á route `POST /restore` (2 ‡∏Å‡∏£‡∏ì‡∏µ) | ‡∏Å‡∏•‡∏≤‡∏á-‡∏¢‡∏≤‡∏Å |
| 6 | ‡πÄ‡∏û‡∏¥‡πà‡∏° UI ‡∏õ‡∏∏‡πà‡∏° backup + ‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô ‡πÉ‡∏ô dashboard | ‡∏Å‡∏•‡∏≤‡∏á |
